<div class="forumdiscussion asideFilter" ng-controller="ForumTopicController as c" style="margin-top:-15px"
     ng-init="c.init('<%- model.slug %>','<%- model.topicId %>')"
     ng-cloak
     ng-click="topicClick()">
    <div ng-show="isLoading" style="position: relative;" ng-cloak ng-style="getBackgroundFontStyle()">
        <div class="loading">
            <span us-spinner="{radius:30, width:8, length: 16,color: getBackgroundFontColor()}"></span>
            <div ng-style="getBackgroundFontStyle()">One moment please...</div>
        </div>
    </div>
    <section ng-if="!isLoading" class="forum-topic-details">

        <div class="row" style="overflow-y:auto;overflow-x:hidden;">
            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12" style="padding-top:15px;">
                <div class="forum-topic clearfix" ng-click="clickTopic(topic)">

                    <div id="forum-topic-header" class="forum-topic-header " style="margin: 0;">
                        <div class="row">
                            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 text-sm forum-breadcrumbs">
                                <a style="font-size:14px;font-weight: bolder" ng-click="backToForum()"
                                   href="javascript:void(0)">{{program.title}}Topics</a>
                                <span class="current">
                                    <span class="fa fa-arrow-left"
                                          style="margin-right:5px;"></span><span><ng-quill-editor ng-model="topic.title" read-only="true"></ng-quill-editor></span>
                                </span>
                            </div>
                        </div>
                        <div class="row" style="max-height:190px;overflow-y:auto;overflow-x:hidden;">
                            <div class="forum-content">
                                <div ng-class="{  'col-lg-7 col-sm-7 col-xs-12' : topic.users.length>0, 'col-xs-12 col-sm-12 col-sm-12':  topic.users.length==0}">
                                    <div class="row">
                                        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                            <div class="forum-avatar col-lg-1 col-md-1 col-sm-1 col-xs-1">
                                                <img ng-if="topic.createdBy.avatarUrl" alt=""
                                                     ng-src="{{topic.createdBy.avatarUrl + '/100x100'}}" style="margin-left:0;">
                                                <img ng-if="!topic.createdBy.avatarUrl" alt="" src="/img/avatar.jpg" style="margin-left:0;">
                                            </div>
                                            <div class="forum-content col-lg-10 col-md-10 col-sm-10 col-xs-10 mobilepadding" ng-if="topic.users.length==0">
                                                <!--<h1>
                                                    {{topic.title}} <i class="forum-refresh fa fa-refresh"
                                                                       ng-click="refresh()"></i>
                                                </h1>-->

                                                <div class="col-lg-8 col-md-8 col-sm-8 col-xs-12">
                                                    <div class="">
                                                        <ng-quill-editor ng-model="topic.title" read-only="true"></ng-quill-editor>
                                                        <i class="forum-refresh fa fa-refresh" ng-click="refresh()"></i>

                                                    </div>


                                                    <span ng-if="topic.quest" tooltip="Activity" class="badge badge-quest">{{topic.quest.title}}</span>
                                                    <span class="badge badge-challenge" tooltip="Challenge">{{topic.challenge.title}}</span>
                                                    <span class="badge badge-category" ng-if="topic.category"
                                                          tooltip="Category">{{topic.category.name}}</span>
                                                    <span class="text-xs" ng-if="topic.category">By: {{topic.createdBy.firstName}} {{topic.createdBy.lastName}} - {{formatTime(topic.createdAt)}}</span>
                                                    <button class="badge"
                                                            ng-if="topic.createdBy.id == userId && topic.children.length == 0 && topic.categoryId != null"
                                                            ng-click="deleteForumItem($event, topic, true)"
                                                            onfocus="blur()" tabindex="-1" title="Delete Topic"
                                                            style="background:rgba(0,0,0,0.5);border:none">
                                                        <i class="fa fa-times"></i>
                                                    </button>
                                                    <div class="forum-likes">
                                                        <i class="fa"
                                                           ng-class="{'fa-thumbs-up':topic.iLike, 'fa-thumbs-o-up':!topic.iLike}"
                                                           ng-click="likeItem(topic)"></i> {{topic.likes.length}}
                                                        &nbsp;&nbsp;
                                                        <!--<i class="fa"
                                                           ng-class="{'fa-thumbs-down':topic.iDislike, 'fa-thumbs-o-down':!topic.iDislike}"
                                                           ng-click="dislikeItem(topic)"></i> {{topic.dislikes.length}}-->
                                                    </div>
                                                </div>
                                                <div class="col-lg-4 col-md-4 col-sm-4 col-xs-12 zeropadding childFilter text-right text-center-mobile filteralign">
                                                    <button class="btn btn-lg filterButton" type="button" ng-click="childFilterButtonClick()">
                                                        <i class="fa fa-filter" aria-hidden="true"></i>FILTERS ({{userfilterView.length}})
                                                        <span class="dropdownarrow">
                                                            <img src="<%-config.web.contentUrl%>/img/dropdown-arrow.svg">
                                                        </span>
                                                    </button>


                                                </div>
                                            </div>

                                            <div class="forum-content col-lg-10 col-md-10 col-sm-10 col-xs-10 mobilepadding" ng-if="topic.users.length>0" ng-style="{'padding-left':'62px'}">
                                                <!--<h1>
                                                    {{topic.title}} <i class="forum-refresh fa fa-refresh"
                                                                       ng-click="refresh()"></i>
                                                </h1>-->
                                                <div class="">
                                                    <ng-quill-editor ng-model="topic.title" read-only="true"></ng-quill-editor>
                                                    <i class="forum-refresh fa fa-refresh" ng-click="refresh()"></i>

                                                </div>


                                                <span ng-if="topic.quest" tooltip="Activity" class="badge badge-quest">{{topic.quest.title}}</span>
                                                <span class="badge badge-challenge" tooltip="Challenge">{{topic.challenge.title}}</span>
                                                <span class="badge badge-category" ng-if="topic.category"
                                                      tooltip="Category">{{topic.category.name}}</span>
                                                <span class="text-xs" ng-if="topic.category">By: {{topic.createdBy.firstName}} {{topic.createdBy.lastName}} - {{formatTime(topic.createdAt)}}</span>
                                                <button class="badge"
                                                        ng-if="topic.createdBy.id == userId && topic.children.length == 0 && topic.categoryId != null"
                                                        ng-click="deleteForumItem($event, topic, true)"
                                                        onfocus="blur()" tabindex="-1" title="Delete Topic"
                                                        style="background:rgba(0,0,0,0.5);border:none">
                                                    <i class="fa fa-times"></i>
                                                </button>
                                                <div class="forum-likes">
                                                    <i class="fa"
                                                       ng-class="{'fa-thumbs-up':topic.iLike, 'fa-thumbs-o-up':!topic.iLike}"
                                                       ng-click="likeItem(topic)"></i> {{topic.likes.length}}
                                                    &nbsp;&nbsp;
                                                    <!--<i class="fa"
                                                    ng-class="{'fa-thumbs-down':topic.iDislike, 'fa-thumbs-o-down':!topic.iDislike}"
                                                    ng-click="dislikeItem(topic)"></i> {{topic.dislikes.length}}-->
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-5 col-md-5 col-sm-5 col-xs-12 desktop-users-view" ng-if="topic.users.length>0"
                                     style="max-height:67px;overflow-y: auto;overflow-x: hidden;">
                                    <div class="forum-topic-list">
                                        <div class="row">
                                            <div class="pull-right network-user col-lg-6 col-md-6 col-sm-4 col-xs-4"
                                                 ng-if="forumItemUser.user.id != user.id"
                                                 ng-repeat="forumItemUser in topic.users">
                                                <span class="badge user-badge col-xs-12" style="margin-top:3px">{{ forumItemUser.user.firstName + ' ' + forumItemUser.user.lastName }}</span>

                                                <div class="forum-avatar shares">
                                                    <img class="shareAvatar" ng-if="forumItemUser.user.avatarUrl" alt=""
                                                         ng-src="{{forumItemUser.user.avatarUrl + '/100x100'}}">
                                                    <img class="shareAvatar" ng-if="!forumItemUser.user.avatarUrl" alt=""
                                                         src="/img/avatar.jpg">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 childFilter text-center-mobile text-right filter-button-desktop" ng-if="topic.users.length>0">
                                    <button class="btn btn-lg filterButton" type="button" ng-click="childFilterButtonClick()">
                                        <i class="fa fa-filter" aria-hidden="true"></i>FILTERS ({{userfilterView.length}})
                                        <span class="dropdownarrow">
                                            <img src="<%-config.web.contentUrl%>/img/dropdown-arrow.svg">
                                        </span>
                                    </button>


                                </div>
                                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 forum-content contentdetails"
                                     ng-if="topic.content">
                                    <p ng-bind-html="topic.content"></p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="childFilter col-lg-12 col-md-12 col-sm-12 col-xs-12 zeropadding" ng-show="toggle.childFiltersShow">
                        <div class="filtertabs col-lg-12 col-md-12 col-sm-12 col-xs-12">
                            <ul>
                                <li class="datefilter" ng-init="dateFilter()" ng-click="dateFilter()" ng-class="{'active': dateShow}">
                                    <span>Date Range</span>
                                </li>
                                <li class="authorfilter" ng-click="authorFilter()" ng-class="{'active': authorShow}">
                                    <span>Individuals</span>
                                </li>

                                <li class="groupfilter" ng-click="topicFilter()" ng-class="{'active': topicShow}">
                                    <span>Keyword</span>
                                </li>


                            </ul>

                            <div class="tabview col-sm-12 col-xs-12">
                                <div ng-show="dateShow">

                                    <md-content layout-padding ng-cloak class="datePickerCal">

                                        <div class="col-lg-2 col-md-2 col-sm-3 col-xs-12">
                                            <div class="datepickerCont">

                                                <md-datepicker id="date3" ng-model="startDate" md-min-date="commentDate" md-max-date="todayDate" name="startDate" md-placeholder="Start Date (mm/dd/yyyy)" ng-change="datesChanged(startDate, 'start')" md-hide-icons="calendar"></md-datepicker>
                                            </div>


                                        </div>
                                        <div class="col-lg-2 col-md-2 col-sm-3 col-xs-12" style="margin-left:10px;">
                                            <div class="datepickerCont">

                                                <md-datepicker id="date4" ng-model="endDate" name="endDate" md-min-date="commentDate" md-max-date="todayDate" md-placeholder="End Date (mm/dd/yyyy)" ng-change="datesChanged(endDate, 'end')" md-hide-icons="calendar"></md-datepicker>
                                            </div>


                                        </div>
                                        <div class="col-lg-4 col-md-4 col-sm-4 col-xs-12" style="margin-left:10px;">
                                            <button type="button" class="btn dateapplybutton" ng-click="dateApply()">Apply</button>
                                            <button type="button" class="btn dateapplybutton" ng-click="resetDate()">Reset</button>
                                        </div>
                                    </md-content>


                                </div>

                                <div ng-show="authorShow">
                                    <span class="multiselect-native-select" ng-class="multiselectoption">

                                        <div id="showDropdown" class="btn-group open">
                                            <button type="button" class="multiselect dropdown-toggle btn btn-default" id="showDropdownmenu" title="Click to add users" ng-click="showDropdownmenu($event)">
                                                <span class="multiselect-selected-text" ng-show="sharechildrenUserArry.length == 0">Click to add users</span>
                                                <span class="multiselect-selected-text" ng-show="sharechildrenUserArry.length == 1">1 user selected</span>
                                                <span class="multiselect-selected-text" ng-show="sharechildrenUserArry.length > 1">{{sharechildrenUserArry.length}} users selected</span>
                                                <span class="dropdownarrow"><img src="<%-config.web.contentUrl%>/img/dropdown-arrow.svg"></span>
                                            </button>
                                            <ul class="multiselect-container dropdown-menu" ng-show="showDropdown">
                                                <li class="multiselect-item">
                                                    <div class="input-group">
                                                        <input id="searchuser" class="form-control multiselect-search" type="text" placeholder="Search" ng-model="searchuser" ng-change="searchUser(searchuser)">
                                                    </div>
                                                </li>
                                                <p ng-if="childUserGroups.length>0">USER GROUPS</p>
                                                <li ng-repeat="item in childUserGroups">
                                                    <a href="#" class="dropdown-tooltip-icon">
                                                        <label class="checkbox" style="display:inline;">
                                                            <input type="checkbox" value="item.value" ng-model="item.selected" ng-click="childtoggleGroup(item)">
                                                            {{item.name}}
                                                        </label>
                                                        <i ng-click="removeGroup(item)" class="fa fa-times"></i>
                                                        <i tooltip="{{item.tooltip}}" class="fa fa-info-circle"></i>


                                                    </a>

                                                </li>
                                                <p>INDIVIDUALS</p>
                                                <li ng-repeat="item in childrenUserArry | unique:'label'">
                                                    <a href="#">
                                                        <label class="checkbox"><input type="checkbox" value="item.value" ng-model="item.selected" ng-click="childtoggleUser(item)">{{item.label}}</label>
                                                    </a>
                                                </li>
                                                <li ng-if="childrenUserArry.length <= 0">
                                                    <a href="#" style="cursor:default">
                                                        <label class="checkbox" style="cursor:default">
                                                            <p>No Users Found</p>
                                                        </label>
                                                    </a>
                                                </li>
                                            </ul>
                                        </div>

                                    </span>
                                    <span class="save-users">


                                        <span ng-repeat="usr in sharechildrenUserArry">
                                            <ng-container ng-if="usr.label">
                                                <p class="user1"><span>{{usr.label}}</span><span><a href="#" ng-click="removeShareUser(usr)"><img src="<%-config.web.contentUrl%>/img/blue-x.svg" /></a></span></p>
                                            </ng-container>
                                            <ng-container ng-if="!usr.label">
                                                <p class="user1"><span>{{usr.user.firstName}} {{usr.user.lastName}}</span><span><a href="#" ng-click="removeShareUser(usr)"><img src="<%-config.web.contentUrl%>/img/blue-x.svg" /></a></span></p>

                                            </ng-container>


                                        </span>
                                        <span ng-show="sharechildrenUserArry.length > 1" ng-click="createUserGroups($event)"><a href="#" class="SAVE-USERS-TO-GROUP">SAVE USERS TO GROUP</a></span>
                                        <span ng-show="sharechildrenUserArry.length >0"><button type="button" class="btn applybutton" ng-click="individualApply()">Apply</button></span>
                                    </span>

                                </div>

                                <div ng-show="topicShow">
                                    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 topicinput zeropadding">
                                        <input class="form-control multiselect-search searchTopic" type="text" ng-model="searchTopic" placeholder="Search Keywords..." value="{{searchTopic}}" ng-keyup="showApply()">

                                        <button type="button" ng-show="applyButton" class="btn applybutton" ng-click="topicApply(searchTopic)" style="margin-right:10px;">Apply</button>
                                        <button type="button" ng-show="resetButton" class="btn applybutton" ng-click="searchTopic = resetTopic(searchTopic)">Reset</button>
                                    </div>

                                </div>

                            </div>
                            <div class="filtering col-lg-6 col-md-6 col-sm-6 col-xs-12">
                                <i class="fa fa-close" ng-click="resetAllFilters()" ng-if="userfilterView.length>0"></i>
                                <span ng-if="userfilterView.length>0">
                                    Filtering Comments:
                                    <span ng-if="dates">{{dates}}<span ng-if="dates && (userfilterView.length > 1)">,</span></span>
                                    <span ng-if="individualLength > 1">{{individualLength}} Individuals<span ng-if="(individualLength > 1) && (topicSearch)">,</span></span>
                                    <span ng-if="individualLength == 1">{{individualLength}} Individual<span ng-if="(individualLength == 1) && (topicSearch)">,</span></span>

                                    <span ng-if="topicSearch">"{{topicSearch}}" Keywords</span>

                                </span>

                            </div>
                        </div>

                    </div>
                    <div id="forum-content-body" class="forum-content-body" ng-style="getBackgroundFontStyle()"
                         style="overflow-y:auto;overflow-x:hidden;padding:15px 15px 0;">
                        <div class="row" style="margin-top:20px;height:auto" ng-if="topic.media">
                            <div class="col-lg-4 col-md-4 col-sm-6 col-xs-12" ng-repeat="media in topic.media">
                                <div class="panel panel-default">
                                    <div class="panel-heading" style="padding-left:10px;"
                                         ng-class="{'quest-error':mediaHasError(media)}">
                                        <div class="panel-title">
                                            <div class="content">

                                                <div class="row image-media" style="height:auto"
                                                     ng-if="media.type=='image'">
                                                    <div class="col-xs-4">
                                                        <a ng-href="{{media.url}}" target="_blank">
                                                            <img class="thumbnail media"
                                                                 alt=""
                                                                 ng-src="{{media.url}}">
                                                        </a>
                                                    </div>
                                                    <div class="col-xs-8">
                                                        <div class="form-group">
                                                            {{media.name}}
                                                        </div>
                                                        {{media.description}}
                                                    </div>
                                                </div>

                                                <div class="row video-media"
                                                     style="height:auto"
                                                     ng-if="media.type=='video' && media.source=='system'">
                                                    <div class="col-xs-3">
                                                        <img class="thumbnail media" alt="" ng-src="{{media.url}}">

                                                        <div class="video-play" ng-show="media.encodings.length > 0">
                                                            <i class="fa fa-play-circle-o"
                                                               ng-click="playVideo(media)"></i>
                                                        </div>
                                                        <div class="loading-overlay"
                                                             ng-show="media.encodings.length <= 0"
                                                             style="left:15px;right:15px;">
                                                            <div class="loading loading-sm">
                                                                <span us-spinner="{radius:9, width:4, length: 6, color: '#b0b0b7'}"></span>

                                                                <div>encoding...</div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-xs-9">
                                                        <div class="form-group">
                                                            {{media.name}}
                                                        </div>
                                                        {{media.description}}
                                                    </div>
                                                </div>

                                                <div class="row video-media"
                                                     style="height:auto"
                                                     ng-if="media.type=='video' && media.source=='youtube'">
                                                    <div class="col-xs-3">
                                                        <img class="thumbnail media" alt="" ng-src="{{media.coverUrl}}">

                                                        <div class="video-play">
                                                            <i class="fa fa-play-circle-o"
                                                               ng-click="playVideo(media)"></i>
                                                        </div>
                                                    </div>
                                                    <div class="col-xs-9">
                                                        <div class="form-group">
                                                            {{media.name}}
                                                        </div>
                                                        {{media.description}}
                                                    </div>
                                                </div>

                                                <div class="row audio-media"
                                                     style="height:auto"
                                                     ng-if="media.type=='audio'">
                                                    <div class="col-xs-12">
                                                        <videogular vg-player-ready="playerReady(media, $API)" vg-plays-inline="'true'">
                                                            <vg-media vg-type="audio" vg-src="media.sources" vg-native-controls="true"></vg-media>
                                                        </videogular>
                                                    </div>
                                                    <div class="col-xs-12">
                                                        <div class="form-group">
                                                            {{media.name}}
                                                        </div>
                                                    </div>
                                                    {{media.description}}
                                                </div>
                                                <!--<div class="row audio-media"
                                                     style="height:auto"
                                                     ng-if="media.type=='audio'">
                                                    <div class="col-xs-3">
                                                        <div class="form-group">
                                                            <img class="thumbnail media" alt=""
                                                                 src="<%- config.web.contentUrl %>/img/audio.jpg">
                                                        </div>
                                                        <div class="audio-play">
                                                            <i class="fa"
                                                               ng-class="{'fa-play-circle-o':(!media.audio || media.audio.paused),'fa-pause':(media.audio && !media.audio.paused)}"
                                                               ng-click="playPauseAudio(media)"></i>
                                                        </div>
                                                    </div>
                                                    <div class="col-xs-9">
                                                        <div class="form-group">
                                                            {{media.name}}
                                                        </div>
                                                    </div>
                                                    {{media.description}}
                                                </div>-->

                                                <div ng-if="media.type=='text'">
                                                    <div class="form-group">
                                                        {{media.text}}
                                                    </div>
                                                    {{media.description}}
                                                </div>

                                                <div ng-if="media.type=='link'">
                                                    <div class="form-group">
                                                        {{media.link}}
                                                    </div>
                                                    {{media.description}}
                                                </div>
                                                <div ng-if="media.type=='resource'">
                                                    <div class="resourceImage">
                                                        <div style="float:left">Download &nbsp;</div>
                                                        <i class="fa fa-file fa-4x text-muted"></i><br>
                                                    </div>
                                                    <div style="margin-left:77px" class="link-wrap">
                                                        <a ng-href="{{media.url}}" target="_blank">{{media.name}}</a>
                                                    </div>
                                                    {{media.description}}
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row" style="height:auto">
                            <div class="col-xs-12">
                                <div class="forum-comments">
                                    <div ng-if="commentArry.length<=0 && topic.children.length>0" class="col-xs-12 lead"
                                         style="margin-top:40px;font-family: Roboto;font-size: 16px;text-align: left;color: #ffffff;">
                                        No comments matching selected filters.
                                    </div>
                                    <div ng-if="topic.children.length<=0" class="col-xs-12 lead"
                                         style="margin-top:40px;">
                                        Be the first to leave a comment.
                                    </div>
                                    <div class="row" ng-repeat="comment in commentArry">
                                        <div class="col-xs-12">
                                            <div ng-if="topic.children.length>0"
                                                 class="col-xs-12 forum-comment">
                                                <hr style="width:300%" ng-if="$index>0">
                                                <div class="forum-avatar col-lg-1 col-md-1 col-sm-1 col-xs-1">
                                                    <img ng-if="comment.createdBy.avatarUrl" alt=""
                                                         ng-src="{{comment.createdBy.avatarUrl + '/100x100'}}">
                                                    <img ng-if="!comment.createdBy.avatarUrl" alt=""
                                                         src="/img/avatar.jpg">
                                                </div>
                                                <div class="forum-content col-lg-10 col-md-10 col-sm-10 col-xs-10 mobilepadding">
                                                    <span style="margin-left:3px" class="text-xs">By: {{comment.createdBy.firstName}} {{comment.createdBy.lastName}} - {{formatTime(comment.createdAt)}}</span>
                                                    <button class="badge"
                                                            ng-if="comment.createdBy.id == userId"
                                                            ng-click="deleteForumItem($event, comment, false)"
                                                            onfocus="blur()" tabindex="-1" title="Delete Discussion"
                                                            style="background:rgba(0,0,0,0.5);border:none">
                                                        <i class="fa fa-times"></i>
                                                    </button>
                                                    <div>
                                                        <p class="commentText" ng-bind-html="comment.content"></p>
                                                    </div>
                                                    <div class="forum-likes">
                                                        <i class="fa"
                                                           ng-class="{'fa-thumbs-up':comment.iLike, 'fa-thumbs-o-up':!comment.iLike}"
                                                           ng-click="likeItem(comment)"></i> {{comment.likes.length}}
                                                        &nbsp;&nbsp;
                                                        <!--<i class="fa"
                                                           ng-class="{'fa-thumbs-down':comment.iDislike, 'fa-thumbs-o-down':!comment.iDislike}"
                                                           ng-click="dislikeItem(comment)"></i>
                                                        {{comment.dislikes.length}}-->
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div style="height:auto;clear:both">
                                            <div class="col-lg-4 col-md-4 col-sm-6 col-xs-12"
                                                 ng-repeat="media in comment.media">
                                                <div class="panel panel-default">
                                                    <div class="panel-heading" style="padding-left:10px;"
                                                         ng-class="{'quest-error':mediaHasError(media)}">
                                                        <div class="panel-title">
                                                            <div class="content">
                                                                <div class="row image-media" style="height:auto"
                                                                     ng-if="media.type=='image'">
                                                                    <div class="col-xs-4">
                                                                        <a ng-href="{{media.url}}"
                                                                           target="_blank">
                                                                            <img class="thumbnail media"
                                                                                 alt=""
                                                                                 ng-src="{{media.url}}">
                                                                        </a>
                                                                    </div>
                                                                    <div class="col-xs-8">
                                                                        <div class="form-group">
                                                                            {{media.name}}
                                                                        </div>
                                                                        {{media.description}}
                                                                    </div>
                                                                </div>

                                                                <div class="row video-media"
                                                                     style="height:auto"
                                                                     ng-if="media.type=='video' && media.source=='system'">
                                                                    <div class="col-xs-3">
                                                                        <img class="thumbnail media" alt=""
                                                                             ng-src="{{media.url}}">

                                                                        <div class="video-play"
                                                                             ng-show="media.encodings.length > 0">
                                                                            <i class="fa fa-play-circle-o"
                                                                               ng-click="playVideo(media)"></i>
                                                                        </div>
                                                                        <div class="loading-overlay"
                                                                             ng-show="media.encodings.length <= 0"
                                                                             style="left:15px;right:15px;">
                                                                            <div class="loading loading-sm">
                                                                                <span us-spinner="{radius:9, width:4, length: 6, color: '#b0b0b7'}"></span>

                                                                                <div>encoding...</div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="col-xs-9">
                                                                        <div class="form-group">
                                                                            {{media.name}}
                                                                        </div>
                                                                        {{media.description}}
                                                                    </div>
                                                                </div>

                                                                <div class="row video-media"
                                                                     style="height:auto"
                                                                     ng-if="media.type=='video' && media.source=='youtube'">
                                                                    <div class="col-xs-3">
                                                                        <img class="thumbnail media" alt=""
                                                                             ng-src="{{media.coverUrl}}">

                                                                        <div class="video-play">
                                                                            <i class="fa fa-play-circle-o"
                                                                               ng-click="playVideo(media)"></i>
                                                                        </div>
                                                                    </div>
                                                                    <div class="col-xs-9">
                                                                        <div class="form-group">
                                                                            {{media.name}}
                                                                        </div>
                                                                        {{media.description}}
                                                                    </div>
                                                                </div>

                                                                <div class="row audio-media"
                                                                     style="height:auto"
                                                                     ng-if="media.type=='audio'">
                                                                    <div class="col-xs-12">
                                                                        <videogular vg-player-ready="playerReady(media, $API)" vg-plays-inline="'true'">
                                                                            <vg-media vg-type="audio" vg-src="media.sources" vg-native-controls="true"></vg-media>
                                                                        </videogular>
                                                                    </div>
                                                                    <div class="col-xs-12">
                                                                        <div class="form-group">
                                                                            {{media.name}}
                                                                        </div>
                                                                    </div>
                                                                    {{media.description}}
                                                                </div>
                                                                <!--<div class="row audio-media"
                                                                     style="height:auto"
                                                                     ng-if="media.type=='audio'">
                                                                    <div class="col-xs-3">
                                                                        <div class="form-group">
                                                                            <img class="thumbnail media" alt=""
                                                                                 src="<%- config.web.contentUrl %>/img/audio.jpg">
                                                                        </div>
                                                                        <div class="audio-play">
                                                                            <i class="fa"
                                                                               ng-class="{'fa-play-circle-o':(!media.audio || media.audio.paused),'fa-pause':(media.audio && !media.audio.paused)}"
                                                                               ng-click="playPauseAudio(media)"></i>
                                                                        </div>
                                                                    </div>
                                                                    <div class="col-xs-9">
                                                                        <div class="form-group">
                                                                            {{media.name}}
                                                                        </div>
                                                                    </div>
                                                                    {{media.description}}
                                                                </div>-->

                                                                <div ng-if="media.type=='text'">
                                                                    <div class="form-group">
                                                                        {{media.text}}
                                                                    </div>
                                                                    {{media.description}}
                                                                </div>

                                                                <div ng-if="media.type=='link'">
                                                                    <div class="form-group">
                                                                        {{media.link}}
                                                                    </div>
                                                                    {{media.description}}
                                                                </div>
                                                                <div ng-if="media.type=='resource'">
                                                                    <div class="resourceImage">
                                                                        <div style="float:left">
                                                                            Download
                                                                            &nbsp;
                                                                        </div>
                                                                        <i class="fa fa-file fa-4x text-muted"></i><br>
                                                                    </div>
                                                                    <div style="margin-left:77px"
                                                                         class="link-wrap">
                                                                        <a ng-href="{{media.url}}"
                                                                           target="_blank">{{media.name}}</a>
                                                                    </div>
                                                                    {{media.description}}
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row" style="height:auto">
                            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                <form action="" method="post" ng-submit="submitComment($event)">
                                    <div class="forum-comment-edit">
                                        <div class="inner">
                                            <div class="forum-avatar" style="margin-bottom:10px">
                                                <img ng-if="user.avatarUrl" alt="" ng-src="{{user.avatarUrl}}">
                                                <img ng-if="!user.avatarUrl" alt="" src="/img/avatar.jpg">
                                            </div>
                                            <div class="forum-content">

                                                <div class="form-group"
                                                     ng-class="{'has-error':ui.val.content.req}">
                                                    <label for="comment" class="control-label">
                                                        Leave a
                                                        comment
                                                    </label>
                                                    <textarea rows="2" id="comment" ng-model="model.comment"
                                                              class="form-control"></textarea>

                                                    <div class="text-sm text-danger text-val"
                                                         ng-if="ui.val.content.req">
                                                        Comment cannot be empty.
                                                    </div>
                                                </div>

                                            </div>
                                            <div class="row" style="height:auto">
                                                <div class="col-xs-12">
                                                    <div style="float:right">
                                                        <button ng-disabled="commentSubmitting" type="submit"
                                                                class="btn btn-primary submit">
                                                            Submit
                                                        </button>
                                                    </div>
                                                    <div style="float:left">
                                                        <div>
                                                            <div class="row" style="height:auto">
                                                                <div class="col-xs-12 add-media">
                                                                    <button type="button"
                                                                            class="btn btn-primary btn-block media"
                                                                            ng-click="addMedia($event)">
                                                                        Add Media
                                                                    </button>
                                                                    <div class="add-media-popup"
                                                                         ng-class="{'open': ui.addMedia.in}">
                                                                        <div ng-show="ui.addMedia.isLoading"
                                                                             class="loading-overlay">
                                                                            <div class="loading" ng-cloak>
                                                                                <span us-spinner="{radius:30, width:8, length: 16, color: '#b0b0b7'}"></span>

                                                                                <div>One moment please...</div>
                                                                            </div>
                                                                        </div>
                                                                        <div class="panel panel-default no-margin-bottom"
                                                                             ng-click="$event.stopPropagation()">
                                                                            <div ng-style="getHeaderCustomStyle()" class="panel-heading">Add Media</div>
                                                                            <div class="panel-body">
                                                                                <div class="row">
                                                                                    <div class="col-xs-12">
                                                                                        <div class="btn outline btn-block"
                                                                                             ng-file-select
                                                                                             ng-file-change="uploadMedia($files)">
                                                                                            Upload From Your
                                                                                            Computer
                                                                                        </div>
                                                                                        <div class="text-sm text-danger"
                                                                                             ng-if="ui.val.addMedia.type">
                                                                                            Format not supported.
                                                                                        </div>
                                                                                        <div class="text-sm text-danger"
                                                                                             ng-if="ui.val.addMedia.size">
                                                                                            File too large.
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                                <hr>
                                                                                <div class="row"
                                                                                     style="height:auto">
                                                                                    <div class="col-xs-12"
                                                                                         ng-class="{'has-error': ui.val.addMedia.req || ui.val.addMedia.fmt}">
                                                                                        <div>Embed Media</div>
                                                                                        <textarea rows="2" class="form-control"
                                                                                                  placeholder="Embed Text"
                                                                                                  ng-click="$event.stopPropagation()"
                                                                                                  ng-model="ui.addMedia.link"></textarea>

                                                                                        <div class="text-sm text-danger"
                                                                                             ng-if="ui.val.addMedia.req">
                                                                                            Video
                                                                                            embed
                                                                                            text cannot be
                                                                                            empty.
                                                                                        </div>
                                                                                        <div class="text-sm text-danger"
                                                                                             ng-if="ui.val.addMedia.fmt">
                                                                                            Invalid
                                                                                            embed
                                                                                            text.
                                                                                        </div>
                                                                                        <button type="button"
                                                                                                class="btn outline btn-block"
                                                                                                style="margin-top:10px;"
                                                                                                ng-click="selectMediaLink($event,'YouTube');$event.stopPropagation()">
                                                                                            OK
                                                                                        </button>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            <br ng-if="model.media" />

                                            <div class="row" style="height:auto">
                                                <div class="col-lg-4 col-md-4 col-sm-6 col-xs-12"
                                                     ng-repeat="media in model.media">
                                                    <div class="panel panel-default">
                                                        <div class="panel-heading" style="padding-left:10px;"
                                                             ng-class="{'quest-error':mediaHasError(media)}">
                                                            <div style="height:20px;margin-top:-10px">
                                                                <button class="removeMedia"
                                                                        ng-click="removeMedia($event,media)"
                                                                        onfocus="blur()" tabindex="-1"
                                                                        title="Remove Media">
                                                                    <i class="fa fa-times"></i>
                                                                </button>
                                                            </div>
                                                            <div class="panel-title">
                                                                <div class="content">
                                                                    <div class="row image-media" style="height:auto"
                                                                         ng-if="media.type=='image'">
                                                                        <div class="col-xs-4">
                                                                            <a ng-href="{{media.url}}"
                                                                               target="_blank">
                                                                                <img class="thumbnail media"
                                                                                     alt=""
                                                                                     ng-src="{{media.url}}">
                                                                            </a>
                                                                        </div>
                                                                        <div class="col-xs-8">
                                                                            <div class="form-group">
                                                                                <input type="text"
                                                                                       ng-model="media.name"
                                                                                       placeholder="Media name."
                                                                                       title="Media name."
                                                                                       class="form-control">
                                                                            </div>
                                                                            <textarea ng-model="media.description"
                                                                                      placeholder="Media description."
                                                                                      title="Media description."
                                                                                      class="form-control"
                                                                                      rows="2"></textarea>
                                                                        </div>
                                                                    </div>

                                                                    <div class="row video-media"
                                                                         style="height:auto"
                                                                         ng-if="media.type=='video' && media.source=='system'">
                                                                        <div class="col-xs-3">
                                                                            <img class="thumbnail media" alt=""
                                                                                 ng-src="{{media.url}}">

                                                                            <div class="video-play"
                                                                                 ng-show="media.encodings.length > 0">
                                                                                <i class="fa fa-play-circle-o"
                                                                                   ng-click="playVideo(media)"></i>
                                                                            </div>
                                                                            <div class="loading-overlay"
                                                                                 ng-show="media.encodings.length <= 0"
                                                                                 style="left:15px;right:15px;">
                                                                                <div class="loading loading-sm">
                                                                                    <span us-spinner="{radius:9, width:4, length: 6, color: '#b0b0b7'}"></span>

                                                                                    <div>encoding...</div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                        <div class="col-xs-9">
                                                                            <div class="form-group">
                                                                                <input type="text"
                                                                                       ng-model="media.name"
                                                                                       placeholder="Name"
                                                                                       class="form-control">
                                                                            </div>
                                                                            <textarea ng-model="media.description" placeholder="Description"
                                                                                      class="form-control" rows="2"></textarea>
                                                                        </div>
                                                                    </div>

                                                                    <div class="row video-media"
                                                                         style="height:auto"
                                                                         ng-if="media.type=='video' && media.source=='youtube'">
                                                                        <div class="col-xs-3">
                                                                            <img class="thumbnail media" alt=""
                                                                                 ng-src="{{media.coverUrl}}">

                                                                            <div class="video-play">
                                                                                <i class="fa fa-play-circle-o"
                                                                                   ng-click="playVideo(media)"></i>
                                                                            </div>
                                                                        </div>
                                                                        <div class="col-xs-9">
                                                                            <div class="form-group">
                                                                                <input type="text"
                                                                                       ng-model="media.name"
                                                                                       placeholder="Name"
                                                                                       class="form-control">
                                                                            </div>
                                                                            <textarea ng-model="media.description" placeholder="Description"
                                                                                      class="form-control" rows="2"></textarea>
                                                                        </div>
                                                                    </div>

                                                                    <div class="row audio-media"
                                                                         style="height:auto"
                                                                         ng-if="media.type=='audio'">
                                                                        <div class="col-xs-12">
                                                                            <videogular vg-player-ready="playerReady(media, $API)" vg-plays-inline="'true'">
                                                                                <vg-media vg-type="audio" vg-src="media.sources" vg-native-controls="true"></vg-media>
                                                                            </videogular>
                                                                        </div>
                                                                        <div class="col-xs-12">
                                                                            <div class="form-group">
                                                                                {{media.name}}
                                                                            </div>
                                                                        </div>
                                                                        {{media.description}}
                                                                    </div>
                                                                    <!--<div class="row audio-media"
                                                                         style="height:auto"
                                                                         ng-if="media.type=='audio'">
                                                                        <div class="col-xs-3">
                                                                            <div class="form-group">
                                                                                <img class="thumbnail media" alt=""
                                                                                     src="<%- config.web.contentUrl %>/img/audio.jpg">
                                                                            </div>
                                                                            <div class="audio-play">
                                                                                <i class="fa"
                                                                                   ng-class="{'fa-play-circle-o':(!media.audio || media.audio.paused),'fa-pause':(media.audio && !media.audio.paused)}"
                                                                                   ng-click="playPauseAudio(media)"></i>
                                                                            </div>
                                                                        </div>
                                                                        <div class="col-xs-9">
                                                                            <input type="text" ng-model="media.name"
                                                                                   placeholder="Name"
                                                                                   class="form-control">
                                                                            <textarea ng-model="media.description" placeholder="Description"
                                                                                      class="form-control" rows="2"></textarea>
                                                                        </div>
                                                                    </div>-->

                                                                    <div ng-if="media.type=='text'">
                                                                        <div class="form-group">
                                                                            <div text-angular ng-model="media.text"
                                                                                 ng-model="anchorTarget(media)"
                                                                                 ta-toolbar="taToolbar"></div>
                                                                        </div>
                                                                        <input type="text"
                                                                               ng-model="media.description"
                                                                               placeholder="Description"
                                                                               class="form-control">
                                                                    </div>

                                                                    <div ng-if="media.type=='link'">
                                                                        <div class="form-group"
                                                                             ng-class="{'has-error':media.val.link.req || media.val.link.fmt}">
                                                                            <input id="link{{$index}}" type="text"
                                                                                   ng-model="media.link"
                                                                                   class="form-control"
                                                                                   placeholder="Link">

                                                                            <div class="text-xs text-danger"
                                                                                 ng-if="media.val.link.req">
                                                                                Link
                                                                                cannot
                                                                                be empty.
                                                                            </div>
                                                                            <div class="text-xs text-danger"
                                                                                 ng-if="media.val.link.fmt">
                                                                                URL
                                                                                is
                                                                                not
                                                                                properly formatted.
                                                                            </div>
                                                                        </div>
                                                                        <input type="text"
                                                                               ng-model="media.description"
                                                                               placeholder="Description"
                                                                               class="form-control">
                                                                    </div>
                                                                    <div ng-if="media.type=='resource'">
                                                                        <div class="resourceImage">
                                                                            <div style="float:left">
                                                                                Download
                                                                                &nbsp;
                                                                            </div>
                                                                            <i class="fa fa-file fa-4x text-muted"></i><br>
                                                                        </div>
                                                                        <div style="margin-left:77px"
                                                                             class="link-wrap">
                                                                            <a ng-href="{{media.url}}"
                                                                               target="_blank">{{media.name}}</a>
                                                                        </div>
                                                                        <input type="text"
                                                                               ng-model="media.description"
                                                                               placeholder="Description"
                                                                               class="form-control">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
</div>
